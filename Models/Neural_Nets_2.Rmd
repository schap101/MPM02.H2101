---
title: "Neural Net"
output: html_notebook
author: ""
---


```{r, echo= FALSE}
library(tidyverse)
library(neuralnet)
library(caret)
```

```{r, echo= FALSE}
setwd(dirname(getActiveDocumentContext()$path))
df <- read.csv("../Data/hour.csv")
```


```{r}
set.seed(123)
indices <- createDataPartition(df$hr, p=.85, list = F)
```

```{r}
df %>%
mutate(train = row_number() %in% indices) %>%
select(hr, train) %>%
table()
```

```{r}
train <- df %>%
slice(indices)
test_in <- df %>%
slice(-indices) %>%
select(-hr)
test_truth <- df %>%
slice(-indices) %>%
pull(hr)
```

```{r}
set.seed(123)
df_net <- neuralnet(hr ~ weathersit + temp, train, hidden = c(4))
```

