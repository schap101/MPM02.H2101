---
title: "Neural Net"
output: html_notebook
author: ""
---

Load libraries and data set

```{r, echo= FALSE}
library(tidyverse)
library(neuralnet)
library(caret)
library(rstudioapi)
library(rmarkdown)
```

```{r, echo= FALSE}
setwd(dirname(getActiveDocumentContext()$path))
df <- read.csv("../Data/hour.csv")
```


Inspect df

```{r, echo= FALSE}
str(df)
```

```{r, echo= FALSE}
df$season <- as.factor(df$season)
df$yr <- as.factor(df$yr)
df$mnth <- as.factor(df$mnth)
df$hr <- as.factor(df$hr)
df$holiday <- as.factor(df$holiday)
df$weekday <- as.factor(df$weekday)
df$workingday <- as.factor(df$workingday)
df$weathersit <- as.factor(df$weathersit)
```


Split data train/test

```{r}
set.seed(123)
indices <- createDataPartition(df$cnt, p=.85, list = F)
```


```{r echo=FALSE, R.options=list(max.print=10)}
df %>%
mutate(train = row_number() %in% indices) %>%
select(cnt, train) %>%
table()
```


```{r}
train <- df %>%
slice(indices)
test_in <- df %>%
slice(-indices) %>%
select(-cnt)
test_truth <- df %>%
slice(-indices) %>%
pull(cnt)
```


```{r}
set.seed(123)
df_net <- neuralnet(cnt ~ hr + temp, train, hidden = c(4,3))
```

