---
title: "Neural Net"
output: html_notebook
author: ""
---


```{r, echo= FALSE}
library(nnet)
library(gamlss.add)
library(dplyr)
library(ggplot2)
library(caret)
library(ROCR)
library(rstudioapi)
```

```{r, echo= FALSE}
setwd(dirname(getActiveDocumentContext()$path))
df <- read.csv("../Data/hour.csv")
summary(df)
head(df)
```

```{r}
df %>%
  ggplot(aes(x = temp)) +
  geom_histogram(position = "stack", bins = 40)
```

```{r}
set.seed(123)
is_train <- runif(nrow(df)) < 0.8
mean(is_train)
```

```{r}
train <- df[is_train, ]
test <- df[!is_train, ]
```

```{r}
str(train)
```

```{r}
data_ann_1 <- nnet(hr ~ weathersit + temp, data = train, size=24, maxit=100, range=0.1, decay=5e-4)
```

```{r}
plot(data_ann_1)
```

```{r}
pred <- predict(data_ann_1, test, type="raw")
cm_nn <- table(pred=pred, true=test$hr)
cm_nn
```

```{r}
confusionMatrix(as.factor(pred), as.factor(test$hr))
```

```{r}
str(test$hr)
str(pred)
```

```{r}
pred_raw <- predict(data_ann_1, test, decision.values=TRUE, type = "raw")
pred_raw
```
```{r}
pred <- ROCR::prediction(pred_raw, test$hr)
perf <- ROCR::performance(pred, "tpr", "fpr")
plot(perf, lwd=2, col="blue")
abline(a=0, b=1)
```






